<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Elasticsearch on 安迪兒隨手貼</title>
    <link>https://bowwow.tips/tags/elasticsearch/</link>
    <description>Recent content in Elasticsearch on 安迪兒隨手貼</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Copyright &amp;#169; by 安迪兒</copyright>
    <lastBuildDate>Fri, 01 Jan 2016 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://bowwow.tips/tags/elasticsearch/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>How To Install Elasticsearch on Ubuntu 14.04</title>
      <link>https://bowwow.tips/post/20160101/</link>
      <pubDate>Fri, 01 Jan 2016 00:00:00 +0000</pubDate>
      
      <guid>https://bowwow.tips/post/20160101/</guid>
      <description>

&lt;p&gt;最近測東西，都用整理好的docker Elasticsearch叢集&lt;br /&gt;
有點忘了之前Elasticsearch建置方式&lt;br /&gt;
補貼上去年建的Elasticsearch步驟當備忘用&lt;/p&gt;

&lt;h4 id=&#34;1-install-java:37994dfe025e3825acda23c8cc02e738&#34;&gt;1. Install Java&lt;/h4&gt;

&lt;p&gt;官方是說&lt;br /&gt;
[Elasticsearch recommends Oracle JDK version 1.8.0_73]&lt;/p&gt;

&lt;p&gt;這邊可以使用OpenJDK 7或Oracle JDK 8&lt;/p&gt;

&lt;p&gt;OpenJDK 7&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo apt-get update  
sudo apt-get install openjdk-7-jre  
java -version  

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Oracle JDK 8&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo add-apt-repository -y ppa:webupd8team/java  
sudo apt-get update    
sudo apt-get -y install oracle-java8-installer   
java -version  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://goo.gl/9wVhs1&#34; width=&#34;50%&#34;&gt;
&lt;img src=&#34;https://goo.gl/q0QMGs&#34; width=&#34;50%&#34;&gt;&lt;/p&gt;

&lt;h4 id=&#34;2-installing-elasticsearch-1-7-2:37994dfe025e3825acda23c8cc02e738&#34;&gt;2. Installing Elasticsearch 1.7.2&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;sudo wget https://download.elastic.co/Elasticsearch/Elasticsearch/Elasticsearch-1.7.2.deb  
sudo dpkg -i Elasticsearch-1.7.2.deb  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://goo.gl/eW9sxo&#34; width=&#34;50%&#34;&gt;
&lt;img src=&#34;https://goo.gl/iFfmPo&#34; width=&#34;50%&#34;&gt;&lt;/p&gt;

&lt;h4 id=&#34;3-installing-plugin:37994dfe025e3825acda23c8cc02e738&#34;&gt;3. Installing plugin&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;head&lt;br /&gt;
&lt;code&gt;
sudo /usr/share/Elasticsearch/bin/plugin -install mobz/Elasticsearch-head  
&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;marvel&lt;br /&gt;
&lt;code&gt;
sudo /usr/share/Elasticsearch/bin/plugin -install Elasticsearch/marvel/latest  
&lt;/code&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;jdbc river&lt;br /&gt;
版本參考
&lt;a href=&#34;http://xbib.org/repository/org/xbib/Elasticsearch/plugin/Elasticsearch-river-jdbc/&#34;&gt;http://xbib.org/repository/org/xbib/Elasticsearch/plugin/Elasticsearch-river-jdbc/&lt;/a&gt;&lt;br /&gt;
&lt;code&gt;
plugin --install jdbc --url http://xbib.org/repository/org/xbib/Elasticsearch/plugin/Elasticsearch-river-jdbc/1.5.0.5/Elasticsearch-river-jdbc-1.5.0.5-plugin.zip  
&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;jdbc postgresql&lt;br /&gt;
版本參考列表&lt;br /&gt;
&lt;a href=&#34;https://jdbc.postgresql.org/download.html&#34;&gt;https://jdbc.postgresql.org/download.html&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;https://github.com/jprante/Elasticsearch-jdbc&#34;&gt;https://github.com/jprante/Elasticsearch-jdbc&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;wget https://jdbc.postgresql.org/download/postgresql-9.4-1204.jdbc4.jar
wget https://jdbc.postgresql.org/download/postgresql-9.4-1204.jdbc42.jar
/usr/share/Elasticsearch/plugins/jdbc  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://goo.gl/moyQVm&#34; width=&#34;50%&#34;&gt;&lt;/p&gt;

&lt;h4 id=&#34;4-configuring-elasticsearch:37994dfe025e3825acda23c8cc02e738&#34;&gt;4. Configuring Elasticsearch&lt;/h4&gt;

&lt;p&gt;一些Elasticsearch檔案路徑&lt;br /&gt;
- /usr/share/Elasticsearch&lt;br /&gt;
- /etc/Elasticsearch&lt;br /&gt;
- /etc/init.d/Elasticsearch&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo update-rc.d Elasticsearch defaults  

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://goo.gl/1xZljC&#34; width=&#34;70%&#34;&gt;&lt;/p&gt;

&lt;p&gt;設定Elasticsearch.yml檔&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo nano /etc/Elasticsearch/Elasticsearch.yml  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;參考內容:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;marvel.agent.enabled: false
cluster.name: bowwow
node.name: pro-bowwow
node.master: true
node.data: true
index.number_of_shards: 5
bootstrap.mlockall: true
index.cache.field.max_size: 50000
index.cache.field.expire: 10m
index.cache.field.type: soft
threadpool.index.type: fixed
threadpool.index.size: 100
threadpool.index.queue_size: 500
#discovery.zen.ping.multicast.enabled: false  
#discovery.zen.ping.unicast.hosts: [&amp;quot;pro-bowwow&amp;quot;,&amp;quot;node1&amp;quot;,&amp;quot;node2&amp;quot;]

th:
data: /data/data
logs: /data/log
plugins: /data/plugins
work: /data/work

http.cors.allow-origin: &amp;quot;/.*/&amp;quot;
http.cors.enabled: true
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;5-設定完成:37994dfe025e3825acda23c8cc02e738&#34;&gt;5. 設定完成&lt;/h4&gt;

&lt;p&gt;啟用服務嘍&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo service Elasticsearch start  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;測試一下&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl localhost:9200
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://goo.gl/tod19x&#34; width=&#34;70%&#34;&gt;&lt;/p&gt;

&lt;p&gt;從db建一些測試資料進去&lt;br /&gt;
&lt;img src=&#34;https://goo.gl/zOb2kc&#34; width=&#34;50%&#34;&gt;
&lt;img src=&#34;https://goo.gl/CeMO7g&#34; width=&#34;50%&#34;&gt; Â&lt;/p&gt;

&lt;p&gt;測一下7萬筆資料內搜尋的效能&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ab -n 1000 -c 10  &amp;quot;http://demo/songs/data/_search?&amp;amp;q=id:100&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;嗯~~測了一下，從數千筆資料搜尋和從7萬多筆資料搜尋，Requests per second數差不多&lt;br /&gt;
&lt;img src=&#34;https://goo.gl/rgIRYy&#34; width=&#34;70%&#34;&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;收工嘍~收工嘍~&lt;/strong&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>